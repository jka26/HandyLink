<!DOCTYPE html>
<html>
<head>
    <title>HandyLink - Become a Helper</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../assets/helper.css">
    <link rel="icon" type="image/x-con" href="../assets/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
    <header>
        <h1>HandyLink</h1>
    </header>

    
    <section class="hero-section">
        <div class="hero-content">
            <div class="left-side">
                <img src="../assets/taskrabbit.jpg" alt="HandyLink Helper" class="hero-image">
            </div>
            <div class="right-side">
                <form id="RegistrationForm" class="registration-form">
                    <h2>Earn money your way</h2>
                    <p>See how much you can make helping on HandyLink</p>
                    
                    <div class="select-area">
                        <label for="area">Select your area</label>
                        <select id="area" name="area">
                            <option value="">Choose location...</option>
                            <option value="accra">Accra</option>
                            <option value="kumasi">Kumasi</option>
                            <option value="takoradi">Takoradi</option>
                            <option value="tema">Tema</option>
                        </select>
                    </div><br>

                    <div class="select-area">
                        <label for="categories">Choose your category</label>
                        <select id="categories" name="categories">
                            <option value="">Select service type...</option>
                            <option value="Home Cleaning">Home Cleaning</option>
                            <option value="General Mounting">Mounting</option>
                            <option value="Minor Plumbing Repairs">Plumbing Repairs</option>
                            <option value="Moving">Moving</option>
                            <option value="Electrical Help">Electrical</option>
                            <option value="Gardening">Gardening</option>
                            <option value="Furniture Assembly">Furniture Assembly</option>
                        </select>
                    </div>

                    <div class="earnings-preview" id="earningsPreview">
                        <h3>Potential Earnings</h3>
                        <p id="avgEarnings">Select a category to see potential earnings</p>
                        <p>Top performers earn: GHC 2000+ weekly</p>
                    </div>

                    <button class="get-started-button" id="get-started">Get Started</button>
                    <p style="text-align: left; margin-top: 1rem;">
                        Already have an account? <a href="login.html">Log in</a>
                    </p>
                </form>
            </div>
        </div>
    </section>

    <section class="flexible-work">
        <div class="content-container">
            <h1>Flexible work, at your fingertips</h1>
            <p>Find local jobs that fit your skills and schedule.<br> 
               With HandyLink, you have the freedom and support to be your own boss.</p>
        </div>
    </section>
        
        <section class="about">
            <div class="about-content">
                <div class="left-side">
                    <img src="../assets/about.jpg" alt="About HandyLink">
                </div>
                <div class="right-side" style="margin-top:20px;">
                    <h1>What is HandyLink?</h1>
                    <p>HandyLink is a platform that connects busy individuals in need of help with trusted local service providers who can assist with a variety of tasks, such as home repairs, errands, and household services. HandyLink enables users to find competent professionals in their area to complete jobs, while also providing service providers the flexibility to work when and where they choose, earning money by showcasing their skills and experience.</p>
                </div>
            </div>
        </section>

        <section class="requirements">
            <h2>Requirements to become a Helper</h2>
            <div class="requirements-grid">
                <div class="requirement-card">
                    <h3>Age</h3>
                    <p>Must be 18 years or older</p>
                </div>
                <div class="requirement-card">
                    <h3>ID Verification</h3>
                    <p>Valid government-issued ID</p>
                </div>
                <div class="requirement-card">
                    <h3>Experience</h3>
                    <p>Relevant skills in chosen category</p>
                </div>
                <div class="requirement-card">
                    <h3>Equipment</h3>
                    <p>Basic tools for your service category</p>
                </div>
            </div>
        </section>

        <section class="getting-started-container">
            <h1>Getting Started</h1>
            <div class="steps-grid">
                <div class="step-container">
                    <div class="step-icon">1</div>
                    <h3>Sign up</h3>
                    <p>Create your account and download the Helper app</p>
                </div>
                
                <div class="step-container">
                    <div class="step-icon">2</div>
                    <h3>Build your profile</h3>
                    <p>Select your services and work area</p>
                </div>
                
                <div class="step-container">
                    <div class="step-icon">3</div>
                    <h3>Verify your eligibility</h3>
                    <p>Submit ID and required documentation</p>
                </div>
                
                <div class="step-container">
                    <div class="step-icon">4</div>
                    <h3>Complete registration</h3>
                    <p>Pay one-time registration fee of GHC 50</p>
                </div>
                
                <div class="step-container">
                    <div class="step-icon">5</div>
                    <h3>Set your schedule</h3>
                    <p>Choose your working hours and availability</p>
                </div>
                
                <div class="step-container">
                    <div class="step-icon">6</div>
                    <h3>Start earning</h3>
                    <p>Accept jobs and grow your business</p>
                </div>
            </div>
        </section>

        <section class="testimonials">
            <h2>What our Helpers say</h2>
            <div class="testimonial-container">
                <blockquote>
                    <p>"HandyLink has given me the flexibility to earn extra income while maintaining my own schedule. The platform is easy to use and clients are great!"</p>
                    <cite>- John D., Accra</cite>
                </blockquote>
        
                <blockquote>
                    <p>"I love the freedom to choose my own tasks and set my own rates. HandyLink has helped me build a successful business."</p>
                    <cite>- Sarah K., Kumasi</cite>
                </blockquote>
        
                <blockquote>
                    <p>"The platform connects me with great clients and makes payment processing simple and secure."</p>
                    <cite>- Michael O., Tema</cite>
                </blockquote>
            </div>
        </section>

        <button class="help-button">Help</button>

        <section>
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Contact Us</h4>
                    <p><i class="fas fa-envelope"></i> Email: jarhin004@gmail.com</p>
                    <p><i class="fas fa-phone"></i> Phone: +233 57 842 3117</p>
                </div>
                
                <div class="footer-section">
                    <h4>Additional Information</h4>
                    <ul>
                        <li><a href="#">About Us</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Service</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4>Follow Us</h4>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 Handylink. All rights reserved.</p>
            </div>
        </footer>
        </section>  

        <div id="signupModal" class="modal" style="overflow-x: hidden; overflow-y: auto">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Create your account</h2>
                <p>Create an account to get started. Then we'll text you a link to download the Helper app to complete your registration. Standard call, messaging, or data rates apply.</p>
                
                <form id="signupForm" method="POST">
                    <input type="hidden" id="modalLocation" name="location">
                    <input type="hidden" id="modalCategory" name="category">
                    <input type="email" name="email" placeholder="Email" required>
                    
                    <div class="name-row">
                        <input type="text" name="first_name" placeholder="First Name" required>
                        <input type="text" name="last_name" placeholder="Last Name" required>
                    </div>
                    
                    <div class="phone-input">
                        <select class="country-code" name="country_code">
                            <option value="+233">+233</option>
                        </select>
                        <input type="tel" name="phone_number" placeholder="Mobile Phone" required>
                    </div>
                    
                    <input type="password" name="password" placeholder="Create a password" required>
                    <input type="password" name="confirm_password" placeholder="Confirm password" required>
                    
                    <div class="checkbox-container">
                        <input type="checkbox" id="soleProprietor" required>
                        <label for="soleProprietor">I acknowledge I am a sole proprietor.</label>
                    </div>
                    
                    <p class="terms">By clicking below and creating an account, I agree to HandyLink's <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a>.</p>
                    
                    <button type="submit">Create account</button>
                    <div id="errorMessages" style="color: red;"></div>
                </form>
            </div>
        </div>

        <script>
            // Add this JavaScript
            document.addEventListener('DOMContentLoaded', function() {
                const modal = document.getElementById('signupModal');
                const btn = document.querySelector('.get-started-button');
                const span = document.querySelector('.close');
                const areaSelect = document.getElementById('area');
                const form = document.getElementById('signupForm');
                const errorMessagesDiv = document.getElementById("errorMessages");

                let isValid = true;

                // Add div for error messages if it doesn't exist
                if (!errorMessagesDiv) {
                    const newErrorDiv = document.createElement('div');
                    newErrorDiv.id = 'errorMessages';
                    newErrorDiv.style.color = 'red';
                    form.appendChild(newErrorDiv);
                }

                // Open modal
                btn.onclick = function(e) {
                    e.preventDefault();
                    const selectedArea = document.getElementById('area').value;
                    const selectedCategory = document.getElementById('categories').value;

                    if (!selectedArea || !selectedCategory) {
                        alert('Please select both location and category before proceeding');
                        return;
                    }

                    document.getElementById('modalLocation').value = selectedArea;
                    document.getElementById('modalCategory').value = selectedCategory;
                    modal.style.display = "block";
                }

                // Close modal functions
                span.onclick = function() {
                    modal.style.display = "none";
                }

                window.onclick = function(event) {
                    if (event.target == modal) {
                        modal.style.display = "none";
                    }
                }

                form.addEventListener('submit', function(event) {
                    event.preventDefault();
                    
                    const email = form.querySelector('input[name="email"]').value;
                    const password = form.querySelector('input[name="password"]').value;
                    const errorMessagesDiv = document.getElementById("errorMessages");
                    errorMessagesDiv.innerHTML = '';
                    
                    let isValid = true; // Move this inside the submit handler

                    // Email validation
                    const emailRegex = /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/;
                    if (!emailRegex.test(email)) {
                        errorMessagesDiv.innerHTML += "Invalid email format.<br>";
                        isValid = false;
                    }

                    // Password validation
                    if (validatePassword(password)) {
                        isValid = false;
                    }

                    if (isValid) {
                        const formData = new FormData(this);
                        
                        fetch("../actions/helper_register.php", {
                            method: "POST",
                            body: formData,
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.success) {
                                alert("Registration successful!");
                                window.location.href = "../view/login.php";
                            } else {
                                alert("Error: " + data.message);
                            }
                        })
                        .catch(error => {
                            console.error("An error occurred:", error);
                            alert("An unexpected error occurred. Please try again.");
                        });
                    }
                });

                // Password validation function
                function validatePassword(password) {
                    const requirements = [
                        { test: pw => pw.length >= 8, message: "Minimum length of 8 characters" },
                        { test: pw => /[A-Z]/.test(pw), message: "At least one uppercase letter" },
                        { test: pw => /\d/.test(pw), message: "At least one number" },
                        { test: pw => /[!@#$%^&*(),.?":{}|<>]/.test(pw), message: "At least one special character" }
                    ];

                    let hasError = false;
                    const messages = requirements.map(req => {
                        if (!req.test(password)) {
                            hasError = true;
                        }
                        return `<li style="color: ${req.test(password) ? 'green' : 'red'}">${req.message}</li>`;
                    });

                    errorMessagesDiv.innerHTML += `
                        <div>
                            Password must contain:
                            <ul>${messages.join('')}</ul>
                        </div>`;

                    return hasError;

                    // Confirm password
                    if (password !== confirmPassword) {
                        errorMessagesDiv.innerHTML += "Passwords do not match.<br>";
                        isValid = false;
                    }
                }

                // Existing category earnings code
                const categorySelect = document.getElementById('categories');
                const avgEarnings = document.getElementById('avgEarnings');

                categorySelect.addEventListener('change', function() {
                    const selectedCategory = this.value;
                    if(selectedCategory) {
                        fetch(`../actions/get_earnings.php?category=${encodeURIComponent(selectedCategory)}`)
                            .then(response => response.json())
                            .then(data => {
                                if(data.success) {
                                    avgEarnings.textContent = 
                                        `Average earnings: GHC ${data.fee_low} - ${data.fee_high} per task`;
                                } else {
                                    avgEarnings.textContent = 'Error loading earnings data';
                                }
                            })
                            .catch(error => {
                                console.error('Error:', error);
                                avgEarnings.textContent = 'Error loading earnings data';
                            });
                    } else {
                        avgEarnings.textContent = 'Select a category to see potential earnings';
                    }
                });
            });
        </script>
    </body>
</html>